(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{470:function(t,e,r){t.exports=r.p+"img/marker.139e133.svg"},636:function(t,e,r){var content=r(698);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,r(18).default)("ee1a21d0",content,!0,{sourceMap:!1})},697:function(t,e,r){"use strict";r(636)},698:function(t,e,r){(e=r(17)(!1)).push([t.i,'.basil{background-color:#fff!important;margin:3%}.basil--text{color:#356859!important}.row{color:#356859}.title-text{font-size:1.2rem}.subtitle-text,.title-text{font-weight:700;font-family:"Prompt"}.subtitle-text{color:#c4c4c4;font-size:1rem}.mdc-typography-styles-headline1{font-family:"Prompt";font-size:50}.action-center{display:flex;align-items:center;justify-content:center}',""]),t.exports=e},746:function(t,e,r){"use strict";r.r(e);r(208),r(9),r(123),r(11),r(61);var n=r(23),o={components:{},data:function(){return{dialog:[],isLoadingA:!0,tab:null,accept:"ตกลง",cancel:"ยกเลิก",items:["รายละเอียดการแจ้งเตือน","รายงานการแจ้งเตือน"],imgElephant:"ภาพเหตุการณ์",sceneOfaccident:"จุดเกิดเหตุ",msg_dialog_trash:"ท่านต้องการย้ายการแจ้งเตือนไปที่ถังขยะหรือไม่",reportImages:[],severityLevel:"รุนแรงมาก",locationName:"หมู่บ้านเขาใหญ่",situationTime:"30 กันยายน 2020 Time 15:52",watcher:"ผู้พบเห็น",missionParticipants:"ผู้เข้าร่วมภารกิจ",attendantImages:[],imageList:[],notice:"หมายเหตุ",markers:[{position:{lat:10,lng:10}}],missionId:"",missionInfo:[],reportsList:[],isshowDialog:!0,isLoading:!0,isRemoveLoading:!1,lat:0,lng:0}},mounted:function(){this.getMissionById(),this.getReportOfMission(this.missionId)},methods:{getMissionById:function(){var t=this;return Object(n.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.$fire.firestore.collection("mission").where("missionId","==",t.missionId).get().then((function(e){e.docs.forEach((function(r){t.missionInfo=r.data();var n=r.data().startTimeStamp.toDate();t.missionInfo.startTimeStamp=t.convertDateTime(n),t.missionInfo.severity=0===r.data().severity?"รุนแรงน้อย":1===e.severity?"รุนแรงปานกลาง":"รุนแรงมาก",t.missionInfo.severityColor=0===r.data().severity?"yellow":1===e.severity?"orange":"red"})),t.lat=t.missionInfo.latLng.latitude,t.lng=t.missionInfo.latLng.longitude,t.markers.position={lat:t.missionInfo.latLng.latitude,lng:t.missionInfo.latLng.longitude},t.getAttendants(t.missionInfo.missionId)}));case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.log("Error Get Mission: ",e.t0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])})))()},getReportOfMission:function(t){var e=this;return Object(n.a)(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,e.$fire.firestore.collection("reports").where("missionId","==",t).onSnapshot((function(t){t.docChanges().forEach((function(t){var r,n=t.doc.data();(r=t.doc.data().elephantCharacteristics.length>0?t.doc.data().elephantCharacteristics:[{eat:!1},{onRoad:!1},{angry:!1},{destroy:!1}],"added"===t.type)&&(-1===e.reportImages.findIndex((function(t){return t.imgSrc===n.imgSrc}))&&e.reportImages.push({imgSrc:n.imgSrc}),e.getUserReport(n.accountId,(function(t){-1===e.imageList.findIndex((function(img){return img.imgSrc===t.photoURL}))&&e.imageList.push({imgSrc:t.photoURL});e.reportsList.push({reportId:n.reportId,missionId:n.missionId,locationName:n.locationName,elephantAmount:n.elephantAmount,imgSrc:n.imgSrc,detail:n.reportDetails,timeStamp:e.convertDateTime(n.timeStamp.toDate()),photoURL:t.photoURL,displayName:t.displayName,colorEat:r[0].eat?"#f05454":"grey",colorOnRoad:r[1].onRoad?"#f05454":"grey",colorAngry:r[2].angry?"#f05454":"grey",colorDestroy:r[3].destroy?"#f05454":"grey",animateEat:r[0].eat?"bx-tada":"",animateOnRoad:r[1].onRoad?"bx-tada":"",animateAngry:r[2].angry?"bx-tada":"",animateDestroy:r[3].destroy?"bx-tada":""})})));t.type,t.type}))}));case 3:r.next=8;break;case 5:r.prev=5,r.t0=r.catch(0),console.log("Error get report of mission ",r.t0);case 8:case"end":return r.stop()}}),r,null,[[0,5]])})))()},getUserReport:function(t,e){var r=this;return Object(n.a)(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,r.$fire.firestore.collection("users").doc(t).get().then((function(t){e(t.data())}));case 3:n.next=8;break;case 5:n.prev=5,n.t0=n.catch(0),console.log("Error get user report: ",n.t0);case 8:case"end":return n.stop()}}),n,null,[[0,5]])})))()},getAttendants:function(t){var e=this;return Object(n.a)(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,e.$fire.firestore.collection("mission").doc(t).collection("attendants").onSnapshot((function(t){t.docChanges().forEach((function(t){var r=t.doc.data();if("added"===t.type&&(e.getAttendantsInfo(r.uid,(function(t){e.attendantImages.push({imageSrc:t.photoURL})})),e.isLoading=!1),t.type,"removed"===t.type){var n=t.doc.data();e.getAttendantsInfo(n.uid,(function(t){var r=e.attendantImages.findIndex((function(e){return e.imageSrc===t.photoURL}));e.isLoading=!1,e.attendantImages.splice(r,1)}))}}))}));case 3:r.next=8;break;case 5:r.prev=5,r.t0=r.catch(0),console.log("Error Get Attendats Info: ",r.t0);case 8:case"end":return r.stop()}}),r,null,[[0,5]])})))()},getAttendantsInfo:function(t,e){return Object(n.a)(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,t.get().then((function(t){e(t.data())}));case 3:r.next=7;break;case 5:r.prev=5,r.t0=r.catch(0);case 7:case"end":return r.stop()}}),r,null,[[0,5]])})))()},deleteReportMission:function(t){var e=this;return Object(n.a)(regeneratorRuntime.mark((function r(){var n;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return e.dialog["dialog_"+t]=!1,n=e.reportsList[t].reportId,e.isRemoveLoading=!0,r.next=5,e.$fire.firestore.collection("reports").where("reportId","==",n).get().then((function(t){t.forEach((function(t){var r=t.data();e.moveToTrash(r,(function(){t.ref.delete();var n=e.reportsList.findIndex((function(t){return t.reportId===r.reportId}));e.reportsList.splice(n,1);var o=e.reportImages.findIndex((function(t){return t.imgSrc===r.imgSrc}));e.reportImages.splice(o,1),e.isRemoveLoading=!1}))}))}));case 5:case"end":return r.stop()}}),r)})))()},moveToTrash:function(t,e){var r=this;return Object(n.a)(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,r.$fire.firestore.collection("trashs").doc().set(t).then((function(){e()})).catch((function(t){console.log("Error cannot move: ",t)}));case 2:case"end":return n.stop()}}),n)})))()},convertDateTime:function(t){try{return new Date(t).toLocaleDateString("th-TH",{day:"numeric",month:"long",year:"numeric",hour:"2-digit",minute:"2-digit"})}catch(t){console.log("Error convert date time: ",t)}}},created:function(){this.missionId=this.$route.query.mission}},c=(r(697),r(26)),l=r(86),d=r.n(l),m=r(197),v=r(217),f=r(461),h=r(459),y=r(754),_=r(733),x=r(451),I=r(457),C=r(703),w=r(194),S=r(156),k=r(114),R=r(80),L=r(198),V=r(200),T=r(193),j=r(452),O=r(704),E=r(734),A=r(735),D=r(750),M=r(709),component=Object(c.a)(o,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-card",{attrs:{color:"basil"}},[n("v-container",{staticClass:"justify-center"},[n("v-row",{staticClass:"justify-center pa-2",attrs:{dense:""}},[n("v-col",{attrs:{cols:"11"}},[n("h2",[n("v-icon",{attrs:{"x-large":""}},[t._v("mdi-text-box-check-outline")]),t._v("\n          รายละเอียดภารกิจ\n        ")],1)])],1)],1),t._v(" "),n("v-overlay",{attrs:{value:t.isLoading,opacity:"0.7"}},[n("v-progress-circular",{attrs:{indeterminate:"",size:"64"}})],1),t._v(" "),n("v-tabs",{attrs:{"background-color":"transparent",color:"basil",grow:""},model:{value:t.tab,callback:function(e){t.tab=e},expression:"tab"}},t._l(t.items,(function(e){return n("v-tab",{key:e},[n("h2",[t._v(t._s(e))])])})),1),t._v(" "),n("v-tabs-items",{model:{value:t.tab,callback:function(e){t.tab=e},expression:"tab"}},[n("v-tab-item",[n("v-card",{attrs:{color:"basil",flat:""}},[n("v-container",[n("v-row",[n("v-col",{attrs:{cols:"12",md:"6"}},[n("v-card",{ref:"reportInfo",attrs:{height:"100%"}},[n("v-card-title",{staticClass:"title-text"},[t._v("\n                  "+t._s(t.imgElephant)+"\n                ")]),t._v(" "),n("v-carousel",{staticStyle:{padding:"2%"},attrs:{"hide-delimiters":"",height:"300"}},t._l(t.reportImages,(function(t,i){return n("v-carousel-item",{key:i,attrs:{src:t.imgSrc}})})),1),t._v(" "),n("v-list-item-content",{staticClass:"pt-2 pb-0 pr-0 pl-0"},[n("v-list-item",[n("v-col",{staticClass:"pt-1 pb-0 pr-0 pl-0 pr-0",attrs:{cols:"3",md:"1"}},[n("div",{class:"pa-3 "+t.missionInfo.severityColor+" rounded-circle d-inline-block"})]),t._v(" "),n("v-card-title",{class:"title-text px-0 py-0 "+t.missionInfo.severityColor+"--text"},[t._v("\n                      "+t._s(t.missionInfo.severity)+"\n                    ")])],1)],1),t._v(" "),n("v-card-title",{staticClass:"title-text pt-1"},[t._v("\n                  "+t._s(t.missionInfo.locationName)+"\n                ")]),t._v(" "),n("v-card-subtitle",{staticClass:"subtitle-text"},[t._v("\n                  "+t._s(t.missionInfo.startTimeStamp)+"\n                ")]),t._v(" "),n("v-card-title",{staticClass:"title-text pt-1 pb-1"},[t._v("\n                  "+t._s(t.watcher)+"\n                ")]),t._v(" "),n("v-col",{staticClass:"watcher-image pt-1 pb-1"},[n("vs-avatar-group",{staticStyle:{"justify-content":"left"}},t._l(t.imageList,(function(image,t){return n("vs-avatar",{key:t,attrs:{max:"50"}},[n("img",{staticStyle:{width:"35px",height:"35px"},attrs:{src:image.imgSrc,alt:""}})])})),1)],1),t._v(" "),n("v-card-title",{staticClass:"title-text pt-1 pb-1"},[t._v("\n                  "+t._s(t.missionParticipants)+"\n                ")]),t._v(" "),n("v-col",{staticClass:"watcher-image"},[n("vs-avatar-group",{staticStyle:{"justify-content":"left"}},t._l(t.attendantImages,(function(image,t){return n("vs-avatar",{key:t,attrs:{max:"50"}},[n("img",{staticStyle:{width:"35px",height:"35px"},attrs:{src:image.imageSrc,alt:""}})])})),1)],1),t._v(" "),n("v-row",{staticClass:"mt-1",staticStyle:{padding:"3%"}},[n("v-col",{attrs:{cols:"12",md:"16",align:"center"}},[n("router-link",{staticClass:"black--text h6",staticStyle:{"text-decoration":"none"},attrs:{to:"/mission"}},[n("v-btn",{staticClass:"px-8 mx-10"},[t._v(" กลับ ")])],1)],1)],1)],1)],1),t._v(" "),n("v-col",{attrs:{cols:"12",md:"6"}},[n("v-card",{attrs:{height:"100%"}},[n("v-card-title",{staticClass:"title-text"},[t._v("\n                  "+t._s(t.sceneOfaccident)+"\n                ")]),t._v(" "),n("v-list-item-content",{staticStyle:{padding:"2%"},attrs:{height:"100%"}},[n("GmapMap",{ref:"mapRef",staticStyle:{width:"500px",height:"650px"},attrs:{center:{lat:t.lat||14.4386654,lng:t.lng||101.3722428},zoom:9,"map-type-id":"terrain",options:{zoomControl:!0,mapTypeControl:!1,scaleControl:!1,streetViewControl:!1,rotateControl:!1,fullscreenControl:!0,disableDefaultUi:!1}}},[n("GmapMarker",{ref:"marker",attrs:{position:t.markers.position,type:"module",icon:{url:r(470),scaledSize:{width:80,height:80}}}})],1)],1)],1)],1)],1)],1)],1)],1),t._v(" "),n("v-tab-item",[n("v-overlay",{attrs:{value:t.isRemoveLoading,opacity:"0.7"}},[n("v-progress-circular",{attrs:{indeterminate:"",size:"64"}})],1),t._v(" "),n("v-card",{attrs:{color:"basil",flat:""}},[n("v-card-title",{staticClass:"title-text"},[t._v(t._s(t.sceneOfaccident))]),t._v(" "),t._l(t.reportsList,(function(e,r){return n("v-card",{key:r,staticClass:"mb-5"},[n("v-container",[n("v-row",[n("v-col",{staticStyle:{height:"200px"},attrs:{cols:"6",sm:"2"}},[n("v-img",{attrs:{height:"100%",src:e.imgSrc}})],1),t._v(" "),n("v-col",{attrs:{cols:"6",sm:"4"}},[n("v-list-item",[n("v-avatar",[n("img",{attrs:{src:e.photoURL}})]),t._v(" "),n("v-list-item-content",{staticClass:"px-2"},[n("v-list-item-title",{staticClass:"h3 pt-1"},[t._v("\n                      "+t._s(e.displayName)+"\n                    ")]),t._v(" "),n("v-list-item-title",{staticClass:"title-text pt-1"},[t._v("\n                      "+t._s(e.locationName)+"\n                    ")]),t._v(" "),n("v-list-item-subtitle",{staticClass:"subtitle-text pt-1"},[t._v("\n                      "+t._s(e.timeStamp)+"\n                    ")]),t._v(" "),n("v-list-item-title",{staticClass:"pt-1"},[t._v("\n                      จำนวนช้างที่พบ: "+t._s(e.elephantAmount)+"\n                    ")]),t._v(" "),n("v-list-item-subtitle",{staticClass:"pt-1"},[n("v-row",[n("v-col",{staticClass:"d-flex justify-center",attrs:{cols:"6",md:"3"}},[n("vs-tooltip",{scopedSlots:t._u([{key:"tooltip",fn:function(){return[t._v(" ตกมัน ")]},proxy:!0}],null,!0)},[n("i",{class:"bx bx-angry "+e.animateAngry+" bx-md",style:"color: "+e.colorAngry})])],1),t._v(" "),n("v-col",{staticClass:"d-flex justify-center",attrs:{cols:"6",md:"3"}},[n("vs-tooltip",{scopedSlots:t._u([{key:"tooltip",fn:function(){return[t._v(" ขวางถนน ")]},proxy:!0}],null,!0)},[n("i",{class:"bx "+e.animateOnRoad},[n("v-icon",{attrs:{large:"",color:e.colorOnRoad}},[t._v("\n                                mdi-road-variant")])],1)])],1),t._v(" "),n("v-col",{staticClass:"d-flex justify-center",attrs:{cols:"6",md:"3"}},[n("vs-tooltip",{scopedSlots:t._u([{key:"tooltip",fn:function(){return[t._v(" กินอาหาร ")]},proxy:!0}],null,!0)},[n("i",{class:"bx bx-restaurant "+e.animateEat+" bx-md",style:"color: "+e.colorEat})])],1),t._v(" "),n("v-col",{staticClass:"d-flex justify-center",attrs:{cols:"6",md:"3"}},[n("vs-tooltip",{scopedSlots:t._u([{key:"tooltip",fn:function(){return[t._v(" ทำลายของ ")]},proxy:!0}],null,!0)},[n("i",{class:"bx bxs-car-crash "+e.animateDestroy+" bx-md",style:"color: "+e.colorDestroy})])],1)],1)],1)],1)],1)],1),t._v(" "),n("v-col",{attrs:{cols:"12",sm:"6"}},[n("v-list-item-group",[n("v-list-item-title",[n("v-row",{staticClass:"h3 pt-1 title-text"},[n("v-col",{attrs:{cols:"8",md:"4"}},[t._v(t._s(t.notice))]),t._v(" "),n("v-col",{staticClass:"text-right",attrs:{cols:"4",md:"8"}},[n("v-dialog",{attrs:{value:"false",persistent:"","max-width":"400","retain-focus":!1},scopedSlots:t._u([{key:"activator",fn:function(e){var r=e.on,o=e.attrs;return[n("v-btn",t._g(t._b({staticStyle:{margin:"1%"},attrs:{color:"red"}},"v-btn",o,!1),r),[n("v-icon",{attrs:{color:"white"}},[t._v(" mdi-delete")])],1)]}}],null,!0),model:{value:t.dialog["dialog_"+r],callback:function(e){t.$set(t.dialog,"dialog_"+r,e)},expression:"dialog['dialog_' + indexReport]"}},[t._v(" "),n("v-card",[n("v-card-title",{staticClass:"justify-center title-text",staticStyle:{"font-size":"16px","font-weight":"bold"}},[t._v("\n                              "+t._s(t.msg_dialog_trash)+"\n                            ")]),t._v(" "),n("v-card-actions",[n("v-spacer"),t._v(" "),n("v-btn",{staticClass:"title-text",attrs:{color:"green darken-1",text:""},on:{click:function(e){t.dialog["dialog_"+r]=!1}}},[t._v("\n                                "+t._s(t.cancel)+"\n                              ")]),t._v(" "),n("v-btn",{staticClass:"title-text",attrs:{color:"green darken-1",text:""},on:{click:function(e){return t.deleteReportMission(r)}}},[t._v("\n                                "+t._s(t.accept)+"\n                              ")])],1)],1)],1)],1)],1)],1),t._v(" "),n("v-list-item-content",[n("v-card",{staticClass:"overflow-y-auto",staticStyle:{padding:"3%"},attrs:{elevation:"2",outlined:"",color:"#e8e8e8",height:"100",width:"200"}},[t._v("\n                      "+t._s(e.detail)+"\n                    ")])],1)],1)],1)],1)],1)],1)}))],2)],1)],1)],1)}),[],!1,null,null,null);e.default=component.exports;d()(component,{VAvatar:m.a,VBtn:v.a,VCard:f.a,VCardActions:h.a,VCardSubtitle:h.b,VCardTitle:h.d,VCarousel:y.a,VCarouselItem:_.a,VCol:x.a,VContainer:I.a,VDialog:C.a,VIcon:w.a,VImg:S.a,VListItem:k.a,VListItemContent:R.a,VListItemGroup:L.a,VListItemSubtitle:R.b,VListItemTitle:R.c,VOverlay:V.a,VProgressCircular:T.a,VRow:j.a,VSpacer:O.a,VTab:E.a,VTabItem:A.a,VTabs:D.a,VTabsItems:M.a})}}]);